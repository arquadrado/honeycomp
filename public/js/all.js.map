{"version":3,"sources":["app.js","helpers.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["Vue.config.debug = true;\n\nvar windowWidth = $('.content').width();\n\nvar beehiveFactory = new BeehiveFactory();\n\nvar apiaries = handover.apiaries.map(function(el){\n\tvar beehiveFactory = new BeehiveFactory();\n\tvar apiary = new Apiary(el, beehiveFactory);\n\tapiary.setBeehives();\n\treturn apiary;\n});\n\nvar currentApiary = (function(){\n\tfor(var i = 0; i < apiaries.length; i++){\n\t\tif(handover.current_apiary.id === apiaries[i].id){\n\t\t\treturn apiaries[i];\n\t\t}\n\t};\n\treturn null;\n})();\n\nvar currentBeehive = (function(){\n\tif (currentApiary !== null && handover.current_beehive){\n\t\tfor(var i = 0; i < currentApiary.beehives.length; i++){\n\t\t\tif (currentApiary.beehives[i].id === handover.current_beehive.id){\n\t\t\t\treturn currentApiary.beehives[i];\n\t\t\t}\n\t\t};\n\t\treturn currentApiary.beehives[0];\n\t}\n\treturn null;\n})();\n\nVue.component('beehive', {\n\tprops: ['beehive'],\n\ttemplate: '#beehive',\n\tdata: function(){\n\t\treturn {\n\n\t\t};\n\t},\n\tcomputed: {\n\t\tbeehivesCount: function(){\n\t\t\treturn this.$parent.beehivesCount;\n\t\t},\n\t\tbeehiveIndex: function(){\n\t\t\treturn this.$parent.apiary.beehives.indexOf(this.beehive);\n\t\t},\n\t\tisActive: function(){\n\t\t\treturn this.beehive === this.$parent.currentBeehive ? '#fece06' : '#dddddd';\n\t\t},\n\t\tisFirstInRow: function(){\n\t\t\treturn this.beehiveIndex % (Math.floor(this.$root.width/60.62)) === 0;\n\t\t},\n\t\tisĹastInRow: function(){\n\t\t\treturn this.beehiveIndex % (Math.floor(this.$root.width/60.62)) === ((Math.floor(this.$root.width/60.62)) - 1);\n\t\t},\n\t\tinOddRow: function(){\n\n\t\t\tvar numberOfColumns = Math.floor(this.$root.width/60.62);\n\t\t\tvar numberOfRows = Math.ceil(this.beehivesCount/numberOfColumns);\n\t\t\tfor(var i = 0; i < numberOfRows; i++){\n\t\t\t\tif(this.beehiveIndex >= (i * numberOfColumns) &&\n\t\t\t\t   this.beehiveIndex < ((i * numberOfColumns) + numberOfColumns)) {\n\t\t\t\t\treturn i % 2 !== 0;\n\t\t\t\t} \n\t\t\t}\n\t\t},\n\t\taddMargin: function(){\n\t\t\treturn this.isFirstInRow && this.inOddRow;\n\t\t}\n\t},\n\tmethods: {\n\t\tactivateBeehive: function(){\n\t\t\tthis.$dispatch('activateBeehive', this.beehive);\n\t\t\tthis.active = true;\n\t\t}\n\t}\n});\n\nVue.component('apiary', {\n\tprops: ['apiary'],\n\ttemplate: '#apiary',\n\tdata: function(){\n\t\treturn {\n\t\t\tshowModal: false\t\n\t\t}\n\t},\n\tcomputed: {\n\t\tbeehivesCount: function(){\n\t\t\treturn this.apiary.beehives.length;\n\t\t},\n\t\tcurrentBeehive: function(){\n\t\t\treturn this.$parent.selectedBeehive;\n\t\t} \n\t},\n\tmethods: {\n\t\tdeleteBeehive: function(){\n\t\t\tif (confirm('Tem a certeza que quer remover esta colmeia?')){\n\t\t\t\tvar beehiveIndex = this.apiary.beehives.indexOf(this.$root.selectedBeehive);\n\t\t\t\tthis.apiary.removeBeehive(this.currentBeehive);\n\t\t\t\tconsole.log(this.apiary.beehives.length);\n\t\t\t\tvar beehiveToActivate = beehiveIndex >= this.apiary.beehives.length ? beehiveIndex - 1 : beehiveIndex;\n\t\t\t\tthis.$dispatch('activateBeehive', this.apiary.beehives[beehiveToActivate]);\n\t\t\t}\n\t\t}\n\t}\n});\n\nVue.component('modal', {\n    template: '#modal',\n    props: [\n    \t'show',\n    \t'beehive'\n    ],\n    methods: {\n    \tsaveInformation: function(){\n    \t\tconsole.log('saving');\n    \t\tvar data = {\n    \t\t\tname: this.$parent.currentBeehive.name,\n    \t\t\ttype: this.$parent.currentBeehive.type,\n    \t\t\tpopulation: this.$parent.currentBeehive.colony.population,\n    \t\t};\n    \t\tvar url = this.beehive.editor_route;\n    \t\tbeehiveAjaxUpdate(data, url, 'POST');\n    \t\tthis.show = false;\n    \t}\n    }\n});  \n\n\n\n\nvar app = new Vue({\n\tel: '#app',\n\tdata: {\n\t\tapiaries: apiaries,\n\t\tselectedApiary: currentApiary,\n\t\tselectedBeehive: currentBeehive,\n\t\twidth: windowWidth\n\t},\n\tmethods: {\n\t\tselectApiary: function(apiary){\n\t\t\tthis.selectedApiary = apiary;\n\t\t\tthis.selectedBeehive = this.selectedApiary.beehives[0]; \n\t\t\tthis.selectedApiary.saveInSession();\n\t\t},\n\t\tdeleteApiary: function(apiary){\n\t\t\tif (confirm('Tem a certeza que quer apagar este apiário?')) {\n\t\t\t\tvar index = this.apiaries.indexOf(apiary);\n\t\t\t\tif (index > -1) {\n\t\t\t\t    this.apiaries.splice(index, 1);\n\t\t\t\t    this.selectedApiary.remove(apiary);\n\t\t\t\t    this.selectedApiary = this.apiaries[0];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tisCurrentApiary: function(apiary){\n\t\t\treturn apiary === this.selectedApiary;\n\t\t}\n\t},\n\tevents: {\n\t\t'delete': function(){\n\t\t\tthis.deleteApiary(this.selectedApiary);\n\t\t},\n\t\t'activateBeehive': function(beehive){\n\t\t\tthis.selectedBeehive = beehive;\n\t\t},\n\t\t'test': function(width){\n\t\t\tthis.width = width;\n\t\t}\n\t}\n});\n\n$(window).on('resize', (event) => {\n\tvar containerWidth = $('.content').width();\n\tapp.$emit('test', containerWidth);\n});\n\n\n\n//constructors\nfunction Apiary(model, factory){\n\tthis.id = model.id;\n\tthis.user_id = model.user_id;\n\tthis.name = model.name;\n\tthis.location = model.location;\n\tthis.dominant_flora = model.dominant_flora;\n\tthis.editor_route = model.editor_route;\n\tthis.create_beehive_route = model.create_beehive_route;\n\tthis.setBeehives = function(){\n\t\tthis.beehives = model.beehives.map(function(el){\n\t\t\treturn factory.createBeehive(el);\n\t\t});\n\t};\n\tthis.beehives = model.beehives;\n\tthis.remove = function(){\n\t\tthis.ajaxRequest(this, 'http://mel.local/apiarios/apagar', 'POST');\n\t};\n\tthis.removeBeehive = function(beehive){\n\t\tvar index = this.beehives.indexOf(beehive);\n\t\tif (index > -1) {\n\t\t    this.beehives.splice(index, 1);\n\t\t}\n\t\t//this.ajaxRequest(beehive, beehive.deleteRoute, 'POST')\n\t};\n\tthis.saveInSession = function(){\n\t\tthis.ajaxRequest(this, 'http://mel.local/apiarios/sessao', 'POST');\t\n\t}\n\tthis.ajaxRequest = function(item, url, method){\n\t\t$.ajax({\n\t\t\turl: url,\n\t\t\tdata: {\n\t\t\t\t'_token': handover.token,\n\t\t\t\t'item_id': item.id\n\t\t\t},\n\t\t\tmethod: method,\n\t\t\tsuccess: function(){\n\t\t\t\tconsole.log('success');\n\t\t\t},\n\t\t\terror: function(){\n\t\t\t\tconsole.log('error');\n\t\t\t}\n\t\t});\n\t};\n}\n\nfunction BeehiveFactory(){\n\tthis.index = 0;\n\tthis.createBeehive = function(model){\n\t\treturn {\n\t\t\tindex: this.index++,\n\t\t\tid: model.id,\n\t\t\tapiary_id: model.apiary_id,\n\t\t\tname: model.name,\n\t\t\ttype: model.type,\n\t\t\tcolony: model.colony,\n\t\t\teditorRoute: model.editor_route,\n\t\t\tdeleteRoute: model.delete_route\n\t\t};\n\t}\n}\n\n","function beehiveAjaxUpdate(data, url, method){\n\t$.ajax({\n\t\turl: url,\n\t\tdata: {\n\t\t\t'_token': handover.token,\n\t\t\t'data': data\n\t\t},\n\t\tmethod: method,\n\t\tsuccess: function(){\n\t\t\tconsole.log('success');\n\t\t},\n\t\terror: function(){\n\t\t\tconsole.log('error');\n\t\t}\n\t});\n}"],"sourceRoot":"/source/"}